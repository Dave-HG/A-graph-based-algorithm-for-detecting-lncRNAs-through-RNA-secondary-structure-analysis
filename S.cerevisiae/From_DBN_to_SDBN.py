##########################################################################
##############               START FUNCTIONS                ##############

#########################################################################
####   Given the DBN a number vector codifying the DBN is obtained   ####
def dbn2vector(P):
    p = len(P)
    PairsP = []
    for i in range(p):
        if P[i] == '.':
            PairsP.append([i, i])
        elif P[i] == '(':
            PairsP.append([i, 1])
        elif P[i] == ')':
            PairsP.append([i, -1])

    for r in range(p):
        if PairsP[r][1] == -1:  
           for s in range(r):
                if PairsP[r-s][1] == 1:  
                    PairsP[r][1] = PairsP[r-s][0]
                    PairsP[r-s][1] = PairsP[r][0]
                    break
    return (PairsP)

###################################################
##  Given the number vector the DBN is obtained  ##
def vector2dbn(E):
    e = len(E)
    G = ''
    for j in range(e):
        if E[j][0] == E[j][1]:
            G = G+'.'
        elif E[j][0] < E[j][1]:
            G = G+'('
        elif E[j][0] > E[j][1]:
            G = G+')'
    return G

###################################################
###  Looks for one step stems and removes them  ###
def remstep(E):
    e = len(E)
    conte = 0
    for g in range(e-2):
        if E[g][0] == E[g][1] and E[g+1][0] != E[g+1][1] and E[g+2][0] == E[g+2][1]:
            p = E[g+1][1]
            conte = conte+1
    for h in range(conte):
        g = 0
        while g < e-2:
            if E[g][0] == E[g][1] and E[g+1][0] != E[g+1][1] and E[g+2][0] == E[g+2][1]:
                p = E[g+1][1]
                if E[p-1][0] == E[p-1][1] and E[p][0] != E[p][1] and E[p+1][0] == E[p+1][1]:
                    E[g+1][1] = E[g+1][0]
                    E[p][1] = E[p][0]
                    break
            g = g+1
    return E

####################################################
# Removes bulges without two consecutive basepairs #
def rembulge(D):
    E = D
    n = len(E)
    cont = 0
    for g in range(n-2):  # Este es un punto E[g+1][0]==E[g+1][1].
        if E[g+1][0] == E[g+1][1] and D[g][0] != D[g][1] and D[g+2][0] != D[g+2][1]:
            if abs(D[g][1]-D[g+2][1]) < 3:
                cont = cont+1
    for h in range(cont):
        n = len(D)
        i = 0
        while i < n:
            if D[i][0] != D[i][1] and D[i+1][0] == D[i+1][1] and D[i+2][0] != D[i+2][1]:
                if abs(D[i][1]-D[i+2][1]) == 1:
                    for k in range(n):
                        if D[k][0] > D[i+1][0]:
                            D[k][0] = D[k][0]-1
                    for k in range(n):
                        if D[k][1] > D[i+1][1]:
                            D[k][1] = D[k][1]-1
                    D.remove(D[i+1])
                    break
                if abs(D[i][1]-D[i+2][1]) == 2:
                    g=D[i+2][1]+1
                    D[g][1] = D[i+1][0]
                    D[i+1][1]=D[g][0]
            i = i+1
    return D

####################################################
#####  Adds a point to junctions where nedded  ##### 
def addpoint(E): 
  n=len(E)
  cont3=0
  for g in range(n-2):
    if E[g][0]!=E[g][1] and E[g+1][0]!=E[g+1][1]:
        if abs(E[g][1]-E[g+1][1])>1:
          cont3=cont3+1
  for h in range(cont3):
    g=0
    while g<n:
      if E[g][0]!=E[g][1] and E[g+1][0]!=E[g+1][1]:
          if abs(E[g][1]-E[g+1][1])>1:
            for k in range(n):
              if E[k][0]>E[g][0]:
                E[k][0]=E[k][0]+1
            for k in range(n):
              if E[k][1]>E[g][0]:
                E[k][1]=E[k][1]+1
            E.insert(E[g][0]+1, [E[g][0]+1,E[g][0]+1])
            break
      g=g+1
  return E
###############               END FUNCTIONS                ###############
##########################################################################


##########################################################################
##############               START ALGORITHM                ##############

###################################################################################
######### In this part the three sets A=AA0, B=BB0, C=CC0 in DBN are added ########
###################################################################################

#AA0 is the set of lncRNAs in DBN (Dot-Bracket Notation)
NOMLNC=['ICR1','RME2','RME3','IRT1','TLC1','PWR1','RUF5-1','RUF21','ETS1-1','SRG1','RUF22','RUF20','ITS1-1','RUF23','ITS2-1','ETS2-1','RNA170','ZOD1']

a0='......(((((((.((((.((((((((((((.(((((((((...((((.(..(((((((....)))))))..).....((((..((((((((((..............))))))....))))....)))).)))).(((.(((....))))))..)))).)))))...(((((.(((((.((((((((.(((((((((.(((((((((..(((((((.......(((....))).((.....((((..((((((((.((((..........).))).))))....))))..)))).....))..)))))))......)))))))))(((((((((((((((((((((..........))))))))....(((.((((.((((((........(((((((....))...(((((((.....((((((((.((.(((....(((...((((.((((((........((((....))))..((((..((((((......((((((..........(.(((((...........))))).)((((((.......))))))....))))))..((((....((((.((((((((((((......))))))).)))))........((...)).))))....((((......))))..))))...(((..((((((.(((.((((((((.....)))........((((((.........((((((...(((((.((((((..(((..(((((...((((.....)))).........((((((..(((((((((..(((((.((((((((..((((.(((((.....(((((((((((((.(.(((((....((...((((.(((((((..((((((........)))))).....(((.....)))........).)))))).))))))..))..)))..((....)).....).)))))).))).))))....))))).(((......(((((((......((((................((((.(((((.......))))).((((..(((((.((.......(((.....(((((.....((((((((((.((.....)).)))))))...))).(((((((...(((((.....))))).((.....)).).))))))......)))))......))).......)))))))...))))......))))((((((..((.((((((...((((.....((((((((......((((((....(((((.........((((((((.(((((.....((((.......))))........((((((((((((..(......)..((((((((..(((((((.....(((.......))).....((((((..((.((((((......))))))...))..))))))))))))).((......))...))))))))..)))))))))).))........................))))).)))...)))))(((((.......(((.((((..(((...)))..)))).))).......)))))..)))))..))))))...((((....)))).......))))))))......(.((((((.......(((.......))).........((((((((((...(((...........)))..))))).))))).....)))))).).....))))..))))).)))...))))))..))))..(((((((((((((....).(((..(((........)))..))).))))))))).)))......(((......)))...........))))))).....(((((....((((((.................((((((...(((......)))...)))..))))))))))))))..)))....)))).....)))))).)))))))..))))))))))))))).)))))(((((((((.....)))))))))(((...(((((.......((((((((.((((((((((.......((((((.........)).)))).......((((...(((.((((.((((((((((.(((.((.......(((((.(((........((((.........((((.....((((....))))..))))......))))......(((((((((((.((((...............)))).......(((((((.....))).)))).....))))))))))).))).))))))).)))))))))).)))..))))..)))...)))).....)))))))))).))).............)))))....)))))..(((....)))....(((.(((((.(((..((........))))).))))).)))....)))..))).)))))).)))))..((((((.(((...))))))))).......))))))....(((((............((((((((((((((((((......((((((....(..(((((((((((....))))))...............)))))..)))))))...........)))))))))))...(((.....))).)))))))...(((((((((..(.((((.....(((((...........)))))....)))).)..))).))))))...)))))...........))))))......))))).)))))))))..))).....))))))..))))...)))))).))))..))).......((((((...)))))).))))).))))))))...((..((........))..))..)))))))...)))))(((((((.(((((.((((((.(...((((.(((..........)))))))....)..)))))).......)).))).)))))))..)))))))))).))).......)).))))))......)))))..)))))))))..((((((((.((((....))).).)).))))))......)))))..)))..............((((((......)))))).....))))).))))).............)))))))...)))))...))))))))))).(((((.((((...(((.....((((((.((......)).))))))....))))))).)))))......'
a1='.((((((..(((........))).................(((((((((((......((((((......((((....))))....((((((((....((((((.((....(((((....((.(((((..((((.....((((((..(((((........)))))..((((.(....)))))...........))))))...)))).........(((.((((..(((...(((((.((((..(((..(((((((((.....).))))))))..)))..))))))))).)))..)))).)))..............(((((((....(((....(((((.........(((.....((((....(((((((((...)).))))))).))))..))).((((((((..(.(((((.((((....(((((((((..((((((((((..(((.((..((......)).)).)))...)))))........((((.....((((((((....((((((...(((((....)))))..)))))).....(((((((..((...(((............)))....))..)))))))..))))))))(((..(((......((((((.......))))))....))).......((((....)))).....))).....................))))....))))).....(((((((.....((((((((...............((((.(((((((((.((((..(((....))).......((((...))))...))))......((((((((.((((((...))))))..))))))))...)))))).................((((((.(((((((((((((((((.(((.(((.....)))))).((.....))...........))))))))).....((((..((((...((((((((.(((.(((......))).)))))))))))..))))(((((....((.((((((.((....)).))).)))))......))))).)))).(((((((........)))))))..........(((((.....(((((......))))).....))))).......)))))))).))))))...)))))))...((((((((......))))))))...))))))))..(((((((((((((((((..(((...(((((......(((...(((((...)))))))).(((....))).))))).((((((((...(((((((.........(((((((((.....(((((....)))))..(((((..((((..(((((....))))))))).((.((.....)).))..)))))(((((.((((.((((......(((.(((((((((((...))))))).)))).)))((((..((((((....(((.(.((((((....((((..((((.....(((..........)))....((((((..............((((((....))))))(((((((......((((..........))))....((((..(........)..)))).......)))))))...)))))).......))))...))))......)))))))))).....)))))))))).)))))))))))))....))))))))).((....))....))))))).(((...(((((...)))))....)))..........)))))))).)))..)))))))).....)))).))).))............)))))))))))))))))))).))...))).)..))))))))..))))).)))....))))))).............)))))..))..))))).....((((...((((..((((....))))..))))..))))......)).)))))))))))))))))))).........)).))))................)))))..)))))).....((((((((.(.....).))))))))....((((((.((((.....))))(((.....)))..)))))).((((((................(((.......((((........))))....((((((........))).))).......))).((((((((.....(((....((...))...)))....))))))))........)))))).'
a2='.....((((((..(((((....(((..(((((....))))).....))).......(((((...((((.(((............((((((.(((...(((((((.....((..(((((((..((((.(((((((((....)))))).))).)))).))))).)).))..))))..))).....((((((((((.....(((......((.(((.(((.((...)).)))))).))....)))((((((.......))))))..))))))))))....))).)))))).((((((((((((.....((....)).((((.(((((((((((....(((((((((((((......(((...(((.(((...(((....)))..))).)))...)))))))))))).))))......(((((((((((((.........)))))))..........))))))........))))))))))).)))).))))))))))))..)))))))..((((((((((..((((((((((((...((((((((((..(((((...((((((((((((......((((((...(((.....(((((....(((((........))))).......)))))...))).......((.((((((..((((((((((((.....(((((....)))))..............(.(((((((((..((((((((...(((((.....(((.........(((.....)))....(((((..((((((...)))))).........((((((.......(((...............)))...((((((((((((.....))))))..)))))))))))).........)))))..))))))))....)))))))).(((((((....)))))))..(((...((((.........)))))))..)))))))))).....))))))))))))......(((..........)))..))))))))..))))))......................((((((...........))))))...)).)))).))))))........(((((((......(((((........))))).....(((((.....)))))..))))))))))))...)))))))))).........((((.........)))).(((((...((((.....)))).....((((........))))....)))))..((((((((.....)))).))))..))))))))..)))).....)))))).))))...)))))...))))).((((((.....((((.((((((...))))))....))))...((((......))))...(((((((((((((...(((((.......)))))..)).))).....)))))))).....))))))..(((((.........)))))......))))))....(((((......(.(((((.((((....((((.(((((.((((((..(((.....(((((((((.......(((((.........((((((((.......(((...............(((..(((((...)).)))..))).((((((.((....(.(((..(......)..))))...)).))))))...............))).......)).))))))........................(((((((((((.(.....((......))...))))...))))))))...)))))..........)).)))))))...)))...)))))).)))))))))...((..(((......)))..)).)))).))))))...(((((.........))))).....)))))..................'
a3='.......((((................(((......(((....(.((((((.((.(((...((((...((((((....))))))((...............((((((.......))))))....((((((.........(((.(((((.((.....(((((...(((.(((................))))))((((((((((((((.((......(((.((((((((.(((((((.((.((.......)).)).)))))))....)))))..))).)))..)).))))))......((((((......)))))).........)))))))).).)))).....))...))))).)))...(((((.((..(((((((........))))))))).))))).....((((((((.(((((((.........((((((((...((((...((.((.....((((((((((((.((((((..((((((((.....((((((.((........((((......))))(((((.....)))))....)).))))))))))).))))).))))(((((...(((((((.....)))))))....((((((((......)))..))))))))))...)))))))))))).....)))).((.((((((.(....).)))))))).)))))))))))).....))))))).))...((((((.(((((((((.((((((......((((((.......((((.......((((........))))....))))...........(((..((((((..................))))))...)))....))))))......((((...(((.((((.......)))).)))..))))..((((....))))..))))))..))).))))))))))))...)))))).....))))))............((.(((((..((((.(((.....(((((.((...)).)))))..(((((.(((.....))).....)))))......)))))))))))))).............)).)))).......(((((.....(((((((.....)))))))..(((((......)))))..))))).))))).))))))).((((((((.(((((..((......)).....(((((((((....(((((((...............((((........(.(((((((((((....)))))..)))))).)...(((...((((....))))..)))............................)))).............(((.....................))).......)))))))....)))))))))))))).)))))))))))..))).((((...(((((((((((...............))))))..)))))....))))..........))))..............'
a4='((((..(((.(((...((((.(((((((((.......((((..(((((.....(((((((((.((((((((((((((......((((((((((..(((((....((((((((((.((((.(((((((((((....((....((((((((..((.(((((((((.(.(((.((((((....((((((((((..((.((((((.((.(((((((..(((((.....)))))....))))).)).)))))))))).))))........(((((..((((..((((......((((((...((((..((((.......))))))))......))))))))))..))))((..((((((((((...(((......)))...))))))))))..)).......................)))))))))))...)).))))))).))))).....))))).))..)))))))))).........(((......)))....((((((.....))))))...)))))))...((((.(((....(((((((((..(((((((...((.....(((((((((.((((......)))).))))))))).((((((...(..((((..(((....(((((((.....)))))))......)))..))))...)...))))))))...))))))).)))))))))....))).)))).(((((.......(((((((................))))))).((((((((((((((((((....((...........)).....)))))))))......))))....)))))))))).)))))))).))).)))))))....)))))..)))).))).))))))))))))))))).))))))))).)))))...)))))))))).))).))))...).))))).((((.((((.(((((..(((.(((...((((...(((.(((((((.(((((..(((((((..((((..(((((((..(((....)))..)))))))..)))).)))).(((((((..(..(..(((............)))..)..))))))))..)))..)))))..))))))).)))))))..))).))).(((..((((((.....(((((((.(((.......((....)).......))).))))))).......)))))).))).))))).))))..((((((.....((((((......(((((...(((..(((((...))))).))))))))...)))))))))))))))).....))))..'
a5='.(((((((..(((....((((...((.....((((((.....(((((((................(((((((....(((..(((.((....)))))..)))..(((((.....((((((.....((((((((((.........))))))))))...((.(((......)))..))...........)))))).((((....((((((......)))...))).....((.(((((((....))))))).)).)))).....)))))....))))))).........(((((((((((...................)))))))))))....)))))))))))))....(((..((((((((((.(((....(((....((((((((((((((.((((((..(((.......))).)))))).).)))).......((((((((..(((..(((((((((..........)))))).((((..................)))).)))..)))..)))))..)))..............)))))))).)....)))......))).))))))))))...........((.((((((((..(.....((((..(((((.....((((((((.............))))))))..)).)))))))...(((((.((.(.((((((....((.((((...((((.(((...)))))))...)))).)).....((.......))..))))))).))))))).((((((((((((....(((((((((((((....)........(((((.(((((((((......((((...(....)..))))...))))))))).)))))....)))).)))))))))))))))))))).)..)))))))).)))))....))..))))....)))...)))))))........'
a6='((((..........((((.((((....))))((((.....))))..(((((((((((.(((((((........................(((((.(((..((((((((......((((.....))))......((((((......(.(((((((((..(.........)..)))).))))))....(((((.((((.....(((....)))))))...)))))))))))...)))))))))))))))).((((......))))...(((......).))........))))))).......((((((((...)))).)))).)))))).)))))..))))...(((((((((((((..((((......)))).....((((((.......((((..(((((((((((....(((..........(((..((((((.....))))))..)))....((((((..((((....)))).((((((((((((((((((((((....))))))))))))))).......((((((.......))))))..)))))))...))))))......(((...)))...)))..))))))))))).....))))..(.(((((........)))))).......(((((((..............)))))))...............))))))..))))))))))).)).....))))..'
a7='........(((((((.........)))))))...((((................((((....))))(((((..(((........)))......(((.((((....))))..((((((...(((..(((.....((((((.....)))))).....)))(((((..(((.(((((((((((...((((((((.....((((......)))).(((...(((((((..(((((((.(((.((((.....((((.......))).)..........((((...((((...((((...........(((..(((((((...((.....))..)))))))..))).(....)..)).))...))))..((...)).))))..)))).))).)))))))...(((((......)))))...)))))))..)))....))))))))....(((((.(((.((((......)))).)))..........((......(((((((((((....))))))))))).......))..........)))))............))))))))))).)))..)))))....)))..((((.(....)))))..))))))......((((((((.((.((((((((....)))))))).)).))))))))....................)))..)))))..............))))....'
a8='.((((((((((..((((((((((((......(((((((....))))))).....)))))))).))))...))))))))))...((((.(((.....(((((......)))))......(((((.((((((((.((((.((......((((((.....))))))((((((.(((((..((((((((((.((((((((....)))))))).)))))))))).)))))))))))......(.(((((((((((.(((....))))))).)))))))).....)))))).))))))))(((((((.((((((.(((................((((((((((.......(((....)))(((((....)))))...))))))))))......((((((..((((((...(((((((((....((((((........))))))...)))))))))....)))))))))))).......))).))))))))).)))))))))...)))..))))..((((......(((((((....)))))))......((((((.((((..((.((((((....)))))).))..)))).))))...))..))))......((((((..((.((((((.(((((((((....((((..(((((((....)))))))..))))...))))))))).))))))))...))))))..'
a9='....(((.......)))..((((.(((..........(((((.....))))).....((.(((..((((...((((....))))...........(((((((((((.(((.(((((((((.(((((((.((.((((......(..(.....)..).((((...........(((((((.((((..(((......((((..(((((...(((...))).(((......)))...)))))..)))).((((.((.....))))))))).....)))).))))))).......)))).....))))..)).)))))))......)))))))))..)))...((((....((((...))))....((((...((((..((((((..(((........)))...)).))))...))))......((((...))))......))))..))))........)))))))))))....))))...)))..))................................)))))))..........(((((.(.....).)))))'
a10='..(((((((((.....))))))).)).............((((((.((((((((.((.((((...(((((((((((....((((....))))......(((((.....))))).))).))))))))..(((((((((..((.....))....(((..((..((((((((.........))))))))....))..))).)))))))))...)))).))))))..)))))))))).((((.(((((((....((((.....)))).....)).))))))))).....((((((...(((((..(((..((((..............((((((((.........(((((.((....((((.(((((....))))).)))).....)).))))).......(.((......)).)...............))))))))...((.(((.......))).))...))))...))).....((((((.....)))).))...))))).))))))........'
a11='.((((((((....((((.......(((..(((((.(((((((.....((((....))).)....(((((......(((((.......((...(((........)))...((((..(((((((..........((..((((...(((((.......))))))))).))..(((((((.....)))))))..)))))))..))))))..(((((((.....(((....((((((...((...(((((((((.........((((......).)))...(((((......))))).....))))).))))...))..))))))...)))......)))))))..)))))....)))))...............))))))).(((.......))).........)))))..)))...))))....))))))))..............'
a12='..((((((....))))))....((((.(((..((((((((((((((((((((((.(((..((((((((((((((.....(((...(((((.(((..((((.((((......))))))))..))).)))))....)))))).)))))))........))))..))).)))).))))))))))))..))))))..))).))))((((.(((.......((((..(....)...........(((((.....(((((.(((((....)))))))))))))))......)))).....................(((((((((.....)))))))))...)))..))))................'
a13='(((((((.....)))))))..(((.(((((((....((((.....)))).((((...((((.....(((((........((((((..(((((((.((((((.....(((((....)).)))...))))))...((....)).......)))))))..))))))..............((((..((.....))..)))))))))......))))))))........))))))).))).......(((....))).'
a14='........((((((......((((((((((...((((....))))..))))...)))))).(((.......((((((((((((((..((((((((((.......((((((((..........))))))))(((((....((.....))....)))))..))))))))))....(((((((......))))..)))....)))))))))))))))))....))))))......'
a15='....(((((((((((((((((((.(((((....))))).))))).))))))))))))))..((..(((.((((((.......(((((((((.............))..))))))).......((((((((((..........)))))))))).))).)))..)))...))...........(((....))).((((((....))))))...'
a16='.................(((.((((.(....................................((((............((.......))..(((((((......)))))))..))))..((((((((........))))))))..).)))).))).............'
a17='(((.((((((..(((....)).).....)))))).)))....................'

AA0=[a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12,a13,a14,a15,a16,a17]


#BB0 is the set of coding RNAs in DBN (Dot-Bracket Notation)
NOMCOD=['15S ribosomal','LSR1','Telomerasa','SNR86','SNR30','Small nucleolar SNR30','SNR19','SNR84','Small nucleolar SNR84','RPM1','SNR17B','Nuclear RNASE P','SNR42','NME1','U3','Small nucleolar U3','RNASE MRP','SNR83']

b0='.............((((((((((((((((((((.......(((.(((((.(((.....(((.(((..(((..((.((((((((((((.(((((....(((((((((((..((....))...((((((((...))))))))................)))))..))))))(((((((((((.....))))))))))).....((((((((.....)))))))))))))...(((.(((((....)))))..(((..((((((((........)))))))))))...))).....)))))))))))).))......(((...(((((((.........)))))))))).....)))...))))))......((((((...(((((....))))).))))))......((((....(((((((...((((((((((((((((((((((((...))))))))))..)))).))))).))))).)))))))...))))............)))..(((((((....((((((((((......(((((((......)))))))..(((((((((((((((((((.......))))))))))))).)))))).......(((((........((((((((.((....))))...)))))).)))))..((((.((((.....))))..(((((((.((((.((((((((..(((((((((((..(((((........)))))...))))))))))).....((((.((((((.((((((((((....((........))...((((((....((((((((((((.(((((.(((......(((((((..((...((((.........))))))..)))))))..........((((((..(((((....((((((...))))))....)))))((....))....))))))..)))...((((.(((((....)))))..))))....)))).).))))))........((..(((((...((..........))....)))))..)).........))))))..))))))....)))))))))).)))))).))))..(((((.........))))).)))))))).))))...(((((((.....((((......)))).....(((..(((((((((....)))))))))..((((((((((.....))))))))))...))).)))))))..........))))))).....((((((.....((((((((((((....((((......)))).....................................................................................(((((((........)))))))..........)))).)))))...)))..((((((.((..(((((..........)))))..)).)))))).)))))).))))........))))))))))...)))))))............................................)))))...(((.........)))......)))..((......)).....(((((((....)))))))))))))....))))))....))))))))...'
b1='((((((.(((..(((....)))..)))..(((.((((..........(((((((......))))))).((((((...)))).)).)))))))...)))))).............((((((...)))))).........(((((((....((((((..(((((.(..(((..((......(((((((((.....(((..(((((((....(((((((.....((((((((((.((((((((((((((((((((....((((((((((((.((((((((((.(((....((((((.((((((.((((.(((((((((((((((((((((((((((((..(((((.(...(((.((((((..(..(((((((..(((((((((((((.......((((((....((((((...((((((...(((((((((((.(((((((((......(((((...((((..((((((((.((....(((((((.(((((((((((((((((((((((((((((((((.((((.((((((((..(((((((..((((.((((((.((((((((((.((..((((((((...((((.(((((.(((((((((((((.(((....))).))))))))..)))))..(((((((....))))))).))))).))))..))))))))..)).)))))))))).)))))).))))...)))))))....))))))))..)))).))))))))))))))))))).....)))))))))))))).)))))))..)).))))))))..))))..))))).....))))))))))))))).)))))..)))))).)))))).......)))))).....))))))))).))))...)))))))..).)))))).)))..).)))))..))))))))))))..))))))))))...))))))).)))).)))))).))))))))).))))))))))))))))))))))...))))......))))))))))))))))...)))))))))))))))))....)))))))..)))....)))))))))))..)))..))))))..)))))).((((((((((((((..(((....)))..((((....)))).........))))))..)))))))).)))))))..............'
b2='(((((((.......((((((.......((((..(((((.....(((((((((.((((((((((((((......((((((((((..(((((....((((((((((.((((.(((((((((((....((....((((((((..((.(((((((((.(.(((.((((((....((((((((((..((.((((((.((.(((((((..(((((.....)))))....))))).)).)))))))))).))))........(((((..((((..((((......((((((...((((..((((.......))))))))......))))))))))..))))((..((((((((((...(((......)))...))))))))))..)).......................)))))))))))...)).))))))).))))).....))))).))..)))))))))).........(((......)))....((((((.....))))))...)))))))...((((.(((....(((((((((..(((((((...((.....(((((((((.((((......)))).))))))))).((((((...(..((((..(((....(((((((.....)))))))......)))..))))...)...))))))))...))))))).)))))))))....))).)))).(((((.......(((((((................))))))).((((((((((((((((((....((...........)).....)))))))))......))))....)))))))))).)))))))).))).)))))))....)))))..)))).))).))))))))))))))))).))))))))).)))))...)))))))))))))))))....(((((((..(((((((.(((.((..((((.(((...((((...(((.(((((((.(((((..(((((((.((..((.(((((((..(((....)))..)))))))))..)).)))).(((((((..(..(..(((............)))..)..))))))))..)))..)))))..))))))).)))))))..))).)))))))))))).)))))))))))..............((....))...'
b3='.....(((..((.....((((((((((.((((((((((..(....((((((((((((((.....((((((..((((.(((..(((((((((.....((..(((((((.....((..((((((((((...((((((..((((..(((((((((((((.(((((((((...(((((((((((.((..(((.(((((.((((((..((.((((.....((((((.(((...((((((((.....(((((((((((.((((.....((((((((..(((.(.(((.(((((((.((((((((((.....(((((......))))).(((((((...(((((..((((((((((.((((.(((((((((.((((((.(((((.((((.((.((((((((((((((((((.((((((((.....(((((.(((.......))).)))))...)).)))))).(((((((.(((((((..(.(((((((((..(((((................)))))))))))))).).)))).....))).))))))).)))))))).....)))))))))).)).))))..))))))))))).))))))))).))))..)))))))))).))))).)))))))...........))))))))))..)))).))).))).).)))..)))).))))....))))......)))))))))))))))))))...))).))))))...)))).))...)))))).))))).))).)))))))))))))))))))))))))))))))))))...))))..))))))....))))))))))..))..)))))))..)).....)))))))))..))).)))).)))))).)))))))))).)))).....)..))))))))))))))))))))....))..)))..............(((((.......((((((((((((.......)))))).))).)))........))))).......'
b4='.......(((...(((.(((..(((.......(((((.(((..(((((((.(((.((((((((((((.((((((......((((((..(...((((......))))..(((((......))))).)..)))))).....))))))((((((...((((((((..(((.((((..(((((((((.(((.(((((((......(((((((.((.(((((((((..(((((((((((.....))))))))....)))..))))).....)))).)).))))))))))))))..))))))))))))........)))).)))..))))))))))))))...)))....))))))))).))).)).....))))))))...((((((....((((.....))))..((((.((((((..((((((...((((..((((((((((((..((.((..((((.((......))))))..)).))..))))).)))))))))))......))))))))))))...)))).)))))).............)))))...............((((....(((((...)))))...))))...)))..))))))))).'
b5='.......(((...(((.(((..(((.......(((((.(((..(((((((.(((.((((((((((((.((((((......((((((..(...((((......))))..(((((......))))).)..)))))).....))))))((((((...((((((((..(((.((((..(((((((((.(((.(((((((......(((((((.((.(((((((((..(((((((((((.....))))))))....)))..))))).....)))).)).))))))))))))))..))))))))))))........)))).)))..))))))))))))))...)))....))))))))).))).)).....))))))))...((((((....((((.....))))..((((.((((((..((((((...((((..((((((((((((..((.((..((((.((......))))))..)).))..))))).)))))))))))......))))))))))))...)))).)))))).............)))))...............((((....(((((...)))))...))))...)))..)))))))))....'
b6='..((((..(((.((....((((((((((.(((..((((((..(((((.....((....((((......(((((.((...(((((..(((.(((((.......))))).))).......)))))..))))))).((((((.((((.....((.(....))))))).)).))))........(((((......(((((..((.....))..))))).....)))))...)))))).....)))))..)))))).))).)))))))))).)).)))))))((((((((((.......))))))))))....((..(((((((((((((..((((...((.(((((..((((...((((((...(((....((.((((...(((((((.((((((...((((.((((((....))))))..))))......)))))))))))))..)))))))))..))))))..))))..(((((....)))))))))).))...))))..(((((...)))))....)))))))))))))..))......(((((((((...........))))))))).'
b7='.(((((((((....(((((((((((.((((((....))).))).....((.(((...))).))........)))))))))))..))...)))))))...........((((((((.((((((.(((((((...(((((((((((((((.....))))))((((((......(((((((((...)))))))))...))))))..)))))).)))..)))))))((((.((((((((((((((((((((((((.....))))))))).(((((........(((((.........))))).((((((...((((((...........((((.....))))........))))))..(((((((.(((.(..((((((((..((.(((.((..(((((((.((..((((...))))..)).))))))).)).))).)).))))))))..)))).))))))).)))))).......)))))....))))))))))....))))).))))..........................)).))))))))).)))...'
b8='.(((((((((....(((((((((((.((((((....))).))).....((.(((...))).))........)))))))))))..))...)))))))........((.(((((((((((..((.(((((((...(((((((((((((((.....))))))((((((......(((((((((...)))))))))...))))))..)))))).)))..))))))))).......((((((((((((((((((((.....))))))))).(((((........(((((.........))))).((((((...((((((...........((((.....))))........))))))..(((((((.(((.(..((((((((..((.(((.((..(((((((.((..((((...))))..)).))))))).)).))).)).))))))))..)))).))))))).)))))).......)))))....)))))))))))......)))))...((((....))))......)))))))).....'
b9='....................(((..........(((((.((((((.(((((((...........(((((((((.......)))))))))........((((((((((((((..........(((((((.....))))))).........)))))))))))))))))))))........((((((((((((.(((.....))).)))))).)))))).(((((((...)))))))...)))))).)))))....((((((((((.........((((((.(((((((......((((.(((((((.......)))))))))))......(((....((..((((((((....))))))))..)).....(((((....)))))..))).))))))).))))))..........((((((((....))))))))......))))))))))...............................))).'
b10='(((...(((.....(((((((((.....((((.(((....))).))))...)))))))))((........))...)))(((((((((..........((((.((.((((((....((((((((((((.....))...(((((.((((((....)))))).(((.((((..((((((((....))))).)))..)).)).)))......))))).))))).......(((((.....))))))))))...)))))).))(((((((.(((..((((((((........))))....)))).)))....)))))))............((((((((..((((((((((.((((...)))).))))))))))...)))))))).))))......(((((.((((((...((((((((.....)))).))))..)))))))))))....))))))))).)))....'
b11='.((((((((..((((((((((....((((((((((.((..((....))..)).))))))))))..(((((....((((((((((...((((((((...((..(((((..........((((((((((((....))))))))))))..))))))).............(((((....))))).))))))))((((((((.((......((((((((((((((....))))))))))).)))))..))))))))...))))))))))((((.(((((((....))).).))).)))))))))........))))))))))(((((....)))))....((....)).....)))))))).'
b12='......((((((((((((...(((((((.(((((..(((((((((((((....(((((.(((.....))).)))))....)))))...........))))))))))))))))))))...........((((((((((..((((..((((((.((((((((((...)))))))))).)))))).)))).)))).))))))....))))))))))))..((((.((((.(((.((((.....))))))).))))))))..((((((((......((((((((((.(.((((((((((((.....))))..)))))))))....)))))))))).....))).)))))......'
b13='..(((((((((((...(((((((......(((((..........((((((((....)))))))).........((((((((((((((((((..((......)).((((.....))))..)))))))..((((........))))...))))))))..))).((((((((....)))))))))))))..(((((((((((.((.....)))))))))).)))......(((..((((((((((....)))))))))).))).......))))))).(((((.....(((((......))).)).....))))).........)))))).))))).......'
b14='..............((((((....)))))).(((.((((..((((((((....))))).)))..)).)).))).(((((...((.(((((.......(((((.....)))))((((((......(((((.((......)).)))))......))))))..))))).(((((.................(((((((...(((((((..((((((((((.((((...)))).))))))))))...))))))))))).)))....(((((.((((((...((((((((.....)))).))))..)))))))))))....)))))..))...)))))'
b15='...((.((((((.....(((((..(((((((((..(((...(((...(((((.(((.....((((............))))))).))))).......(((((.....))))).)))....)))................(((.((.((((........)))))).)))..)))))).....)))........((((...(((((.....((((((((...(((...)))...))))))))......))))))))).)))))..((((((((...((.((((((((...)))))).)).)).....)))))))).....))).))).))......'
b16='.(((((((((((..((((((((......(((((..........((((((((....)))))))).........((((((((((((((((((..((......)).((((.....))))..)))))))..((((........))))...))))))))..))).((((((((....)))))))))))))..(((((((((((.((.....)))))))))).)))......(((..((((((((((....)))))))))).))).......))))))))(((((.....(((((......))).)).....))))).........)))))).)))))'
b17='..((((((((.....((((((........(((((((...((((((.((.(((((((((.((((((((..(((((((.((((((....)))))).))).)))))))))))))))))))))))))))))..........(((((((((...(((((....)))))...)))))..)))).........)))))))))))))........))))))))........(((((........(((((.......((((((((....................)))))))).........))))))))))...'

BB0=[b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,b11,b12,b13,b14,b15,b16,b17]


#CC0 is the set of possible lncRNAs in DBN (Dot-Bracket Notation)
NOMPOSIBLES=['KAP123','GRE2','EMC11', '1477','6754','12189']

c0='..(((........))).........(((((((......(((.((((..(((.(((((((((((.((...(((..(.(((.....))).)..)))...........))))))))......)))))......((((((...........(((((....((((((((((.....((((((........)))))).....(((((((((.....))))).)))))))))))))).....)))))............(((((......((((((.......((((((((((.....((((.(((.(((((.....((((....))))...)))).).))).))))..((((........(((((((((...(((....(((.................)))...))).....(((((((.(((........))).))))))).........((((((.......))))))..)))))))))))))......))))))))))...((((((((((...((((((((.((((((...))))))..))))))))((((((((((((((((............((((....)))).....((((((.((...........(((..........(((((.............)))))....((((((((.((((((((((((.(((.(((.....((((((.((((......))))..))))))...(.(((((((..(((((....)))))...))))))))....)))))).))))))..)))))).)))).)))).)))((..(((((((((((((.(((..((...((((....))))..)).))).))).)))).))))))...))........)).)))))))))))))...))))))..))).......((((((((.....((.(((..((((.....((((.......))))........((((((.((((.....((((((...((((.........))))...))).)))..((((..(..(((....)))..)))))....((.(((......))).))...)))).))))))..))))..))).))..))))))))........)))..)))))))..(((((......))))).........)))))).((((....)))).....((((((((.......))))))))..((((((((...((((.((((((..((....)))))))).)))).....(((..(((((...(((....)))..........((((((((......((((((....)))))).((.(((((...((..(((((...)))))..))...))))).)).......(((((((((.(.....(((((.((.(((....((((((((((.((.(((((.(((((((((.....))).))))))..))))).)).....(((((.(((.(((((.....)))))))).((((((..((((((..((((((((..(((((....)))))(((..(((((((....))))).))..))).........)))))))).....((((....))))))))))...)))))).......)))))...(((..(((((.((.(((((...((.(((....((((((......))))))....))).)).....((((.(((((.(((......))))).)))))))..))))))).)))))..)))......)).....))))))))..((((((((((.((......)))))))).))))..)))..)))))))...((((.((((...((((((((((((((((.(((((..(((((((...((......))..((((((((((.(..(((((.(........))))))......(.(((((......((((.(((((.......)))))))))(((((((..((.((((((((((((......((((.......))))...(((.(((...(((((((.((((((...((((....(......)....))))....))))))))))))).....(((((((((..(((((..(((((((((((......((((..((((....((((((..(((.(((((((..(((((...(((((....(((..(((((.........))))).))).......))))).(((.......((((.............))))........)))..))))).))))))).)))))))))((((((.....))).)))...))))...))))..)))))))))))(((((((.....((((.((((..((((.((((((..((......))..)))))).)))).)))).)))).....(((((((((((.((((((..((((.(((....)))))))..))))))...)))))).........)))))..))))))).....)))))....)))).......(((((........(((((.......)))))..)))))...)))))..))).))).))))).)).))))).))....(((......(((.(((((((((..(((((((((((((.......)))))))...(((((...........))))).......))))))(((((((.(((((((...((((((.....(((((.(((((...(((((...........)))).)...))))))).)))....((((((....(((((((((....((((((((...))))))))...((((((...((((((.((.....((((....))))....)).))))))..)))))).......(((.......)))))))).....))))....(.((((((((((....))..)))))))))...))))))........))))).)..)))))))..(((((......))))).)))))))..)))).))))).))).....(((((((......(((((...)))))..))))))).)))..))))))).....))))))........)))))))))))...........)))))))..((((.(((..(((((.........)))))..))).)))).............)))))....))))))))))...)))))))))))))).).)))))))))...))))))))....)))))))).....))))))))))))).))))))..((((..(((((((((.((((.................))))............(((((.........))))).....)))...))))))...)))).)))..)))))))......)))))))'
c1='.(((((((..(((((((...((((...((((.....)))).......((((((((..((((.(((((..((((....))))..(((((((((.(((.(((.((((.((((((..........(((((..(((((.......)))))..))))).(((((.(((((......((((((..((.....))....(.((.((((((...)))))).)))..))))))...))))))))))....)))))).....))))((.......((((.....))))..(((((((.((((((..(((((....)))))....(((.....)))....)))))).)))).))).)).))))))))))))).))...........)))))....))))..).).)))))).))))...).))))))...((((((...(((((((((......(((((((((((....)))))...((((((..((.((((((((........)))).)))))).((((....((((......))))..((((.(((((.(((((.....((((..........(((((...(((((.........)))))(((((((((.(((.((....))..)))))))))))).........))))).((((((((((.....(((...(((((..((((..((((((....((((((..(((((((....)))))))..).......))))))))))).)))).))))).........((((.((.......(....).(((((((...)))))))......))))))..)))......))))))))))))))....))))).).))))...))))..))))....)))))).))))))((((...(((((...)))))....))))...((((...)))).(((((((.........))))))).....)))))))))..((((((....))))))..)))))).)))))))...((((((..((((((....)))))).)))))).......'
c2='....(((((.....)))))..........((((...................((((...................))))..(((...........................(((((.(((........(((...............(((......))).((....))..))).............................((((.....((((((..(((..............(((......(((...(((((................((.((((((....((......)).......................(((..(((((((..(.(((((.((((......((((..(.((((((..((.(((((((.(....).)))).)))))....(((((((....(((.((...(((((((.............((((........))))...(((........))).)))))))..))))).....((((.(...........(((........)))....((....)).)))))........)))))))......................)))))).)...))))((((.....((...((.((....))))...)).....((((((........))))))......))))............(((((...))))).)))).))))).).))))).)))))..)))))).)).......(((.....)))...)))))...))).......)))........(((.......)))..)))..)))))).......((((..((.....((((((....))))))...))))))))))....))).)))))..........(((((....))))))))........)))).............'
c3='..........(((((.(((...........)))..)))))..(((((.....((((.(((((((((((((((((((..........)))).))).(((((((.(((((..((((..(((((((((..(((((.((((.((((..((((((((...........(((((....((((((..((......(((((((((((.......)))))..)))))).......((((((..((.(((((((...)))))))..((((((((...........(((((((.....(((((((.(((...(((((......))))).......((((((((((((....(((...((((.....)))).........................((((...........((((...))))))))......)))..)))..))))))))).....))))))))))....))))))).....((((.((((.((......))..)))).)))).......))))))))....(((.((......((((((((.(((((.((((.(((.((.((...(((((...........)))))..((.(((......(((.....)))...))).)))).)))))))))..((((....)))))))))....))))))))....)).)))....))..))))))..))..)))))).))))).)))))))).......)))).)))))))))...)))))))))..))))..)))..)).))))))).((((((((...........)))))...))).......)))))))))))).))))(....).))))).......'
c4='((.......((((((.......(((((....((((((((........))))))))((((((.....((((((...((((...)))).))))))..(((.(((.....((((((((..((((((.........))))))..((((.(((.....((((.((((.......(((.....(((((((......))))))).....)))......((((((..((....)))))))).....))))..))))..))).))))..................)))).))))..........((((((....))))))............................))).)))))))))...)))))...)))))).....(((..((((.....(((((..(((((.....(((......((((....)))).(((((.((((...((((....))))..((((((((.....)))))))).)))).........(((((((((.(((...))))))))))))....)))))..)))....(((((..(.(((.....(((.(((......))))))......)))).(((............((((.(((..(((((.((((.....))))....))))).........((((...))))...))).)))).......(((((.((((................((.((((..(((.....)))....)))).))......(.((((((.........)))))))..)))).)))))..........)))....)))))..........))))))))))..))))..)))..))...........'
c5='(((((((............((((.((((((((....((((..........))))....))).)))))..((((....((((((.(((..((......))........(....)...)))))))))...)))).....((((((...(((((................((((.....(((.((((((((((((.............))))))..))))))..)))..)))).........(.((((.(((....))).)))))..)))))))))))......((((..((.((.((((((.(((....((...(((.....(((((.(((...(((......)))))).(((((((.....((((...))))....)))))))................)))))........)))..)).(.....).....))).))..)))).)).(((.....))).))..))))))))...((((((...............))))))...................)).)))))................(((((.(((((............))))))))))......'

CC0=[c0,c1,c2,c3,c4,c5]

#############################################################################
######### In this part add the three sets A=AA0, B=BB0, C=CC0 in DBN ########
#############################################################################


#DD0=AA0  # Use to determine the SDBN of set A (lncRNAs).
#DD0=BB0 # Use to determine the SDBN of set B (coding RNAs).
DD0=CC0 # Use to determine the SDBN of set C (possible lncRNAs).

w = len(DD0)
AA1 = []
for l in range(w):
    AA1.append('...' + DD0[l] + '...')

Reduc=[]


print("\n========================================")
print('Please wait, from DBN to SDBN:')
print("========================================\n")

for j in range(w):
      # Apply the Gan rules to each DBN.
      P = AA1[j]
      D = dbn2vector(P)
      H1 = remstep(D)
      H2 = rembulge(H1)
      H3=addpoint(H2)
      H4=remstep(H3)
      K4=vector2dbn(H4)
      
      # Consecutive sequences of the same character reduced to one character.   
      aaa=len(K4)
      B='.'
      for k in range(aaa-1):
          if K4[k]!=K4[k+1]: 
              B=B+K4[k+1]
      print(j,B)
      print()
      Reduc.append(B)
pass

##############                END ALGORITHM                 ##############
##########################################################################